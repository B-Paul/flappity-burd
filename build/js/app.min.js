!function t(i,s,n){function e(c,h){if(!s[c]){if(!i[c]){var r="function"==typeof require&&require;if(!h&&r)return r(c,!0);if(o)return o(c,!0);var p=new Error("Cannot find module '"+c+"'");throw p.code="MODULE_NOT_FOUND",p}var a=s[c]={exports:{}};i[c][0].call(a.exports,function(t){var s=i[c][1][t];return e(s?s:t)},a,a.exports,t,i,s,n)}return s[c].exports}for(var o="function"==typeof require&&require,c=0;c<n.length;c++)e(n[c]);return e}({1:[function(t,i,s){"use strict";var n=t("../../helpers").clamp,e=function(t,i){this.entity=t,this.radius=i,this.size={x:i,y:i},this.type="circle"};e.prototype.collidesWith=function(t){return"circle"===t.components.collisions.type?this.collideCircle(t):"rect"===t.components.collisions.type?this.collideRect(t):!1},e.prototype.collideCircle=function(t){var i=this.entity.components.physics.position,s=t.components.physics.position,n=this.radius,e=t.components.collisions.radius,o=i.x-s.x,c=i.y-s.y,h=Math.pow(o,2)+Math.pow(c,2),r=n+e,p=Math.pow(r,2);return p>h},e.prototype.collideRect=function(t){var i=this.entity.components.physics.position,s=t.components.physics.position,e=t.components.collisions.size,o=e.x/2,c=e.y/2,h=s.x+o,r=s.x-o,p=s.y+c,a=s.y-c,l=n(i.x,r,h),u=n(i.y,a,p),y=i.x-l,d=i.y-u,f=y*y+d*d,m=this.radius*this.radius;return m>f},i.exports=e},{"../../helpers":12}],2:[function(t,i,s){"use strict";var n=function(t,i){this.entity=t,this.size=i,this.type="rect"};n.prototype.collidesWith=function(t){return"circle"===t.components.collisions.type?this.collideCircle(t):"rect"===t.components.collisions.type?this.collideRect(t):!1},n.prototype.collideCircle=function(t){return t.components.collisions.collideRect(this.entity)},n.prototype.collideRect=function(t){var i=this.entity.components.physics.position,s=t.components.physics.position,n=this.size,e=t.components.collisions.size,o=n.x/2,c=n.y/2,h=e.x/2,r=e.y/2,p=n.x+e.x,a=n.y+e.y,l=i.x-o,u=i.x+o,y=i.y-c,d=i.y+c,f=s.x-h,m=s.x+h,v=s.y-r,g=s.y+r,x=Math.min(l,f),w=Math.max(u,m),S=Math.min(y,v),b=Math.max(d,g),E=p>=w-x,C=a>=b-S;return E&&C},i.exports=n},{}],3:[function(t,i,s){"use strict";var n=function(t){this.entity=t};n.prototype.draw=function(t){var i=this.entity.components.physics,s=i.position,n=this.entity.width,e=this.entity.height,o=i.time/i.period*.2,c=Math.ceil(n/.2);t.save(),t.translate(s.x-n/2-o,s.y-e/2),t.fillStyle="#7b725b",t.fillRect(0,0,n,e),t.fillStyle="#5d4427";for(var h=0;c>h;h++)t.fillRect(.2*h,0,.1,e);t.restore()},i.exports=n},{}],4:[function(t,i,s){"use strict";var n=function(t){this.entity=t};n.prototype.draw=function(t){var i=this.entity.components.physics.position,s=this.entity.width,n=this.entity.height,e="T"===this.entity.attach;t.save(),t.translate(i.x-s/2,e?1-n:0),t.fillStyle=e?"red":"blue",t.fillRect(0,0,s,n),t.restore()},i.exports=n},{}],5:[function(t,i,s){"use strict";var n=function(t){var i=this;this.entity=t,this.image=new Image,this.image.src="images/trump.png",this.imgAspectRatio=0,this.image.addEventListener("load",function(){var t=i.image;i.imgAspectRatio=t.naturalWidth/t.naturalHeight||0})};n.prototype.draw=function(t){var i=this.entity.components.physics.position,s=2*this.entity.radius,n=s/this.imgAspectRatio;t.save(),t.translate(i.x,i.y),t.rotate(-.3+this.entity.components.physics.velocity.y/3),t.translate(-(s/2),n/2),t.scale(1,-1),t.drawImage(this.image,0,0,s,n),t.restore()},i.exports=n},{}],6:[function(t,i,s){"use strict";var n=function(t){this.entity=t,this.time=0,this.position={x:0,y:0},this.velocity={x:0,y:0},this.acceleration={x:0,y:0}};n.prototype.update=function(t){this.time=this.time+t,this.period>0&&(this.time%=this.period),this.velocity.x+=this.acceleration.x*t,this.velocity.y+=this.acceleration.y*t,this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t},i.exports=n},{}],7:[function(t,i,s){"use strict";var n=function(t){this.entity=t};n.sounds=["flap.wav","ching.wav","slap.wav","nothappen.mp3","runwin.mp3"].reduce(function(t,i){return t[i]=new Audio("sounds/"+i),t[i].load(),t},{}),n.prototype.playSound=function(t){var i=n.sounds[t];i.load(),i.play()},n.prototype.flapSound=function(){this.playSound("flap.wav")},n.prototype.scoreSound=function(){this.playSound("ching.wav")},n.prototype.dieSound=function(){this.playSound("slap.wav"),this.playSound("nothappen.mp3")},n.prototype.resetSound=function(){this.playSound("runwin.mp3")},i.exports=n},{}],8:[function(t,i,s){"use strict";var n=t("../components/graphics/altitude-limit"),e=t("../components/physics/physics"),o=t("../components/collisions/rectangle"),c=function(t){this.height=.02,this.width=10,this.components={graphics:new n(this),physics:new e(this),collisions:new o(this,{x:this.width,y:this.height})},this.components.physics.period=.2/.35,this.components.physics.position.x=0,this.components.physics.position.y=this.height/2+t};i.exports=c},{"../components/collisions/rectangle":2,"../components/graphics/altitude-limit":3,"../components/physics/physics":6}],9:[function(t,i,s){"use strict";var n=t("../components/graphics/pipe"),e=t("../components/physics/physics"),o=t("../components/sound/sound"),c=t("../components/collisions/rectangle"),h=function(t,i,s,h){this.attach=s,this.height=i,this.width=.15,this.components={graphics:new n(this),physics:new e(this),sound:new o(this),collisions:new c(this,{x:this.width,y:this.height})};var r=this.components.sound,p=r.scoreSound.bind(r);this.components.physics.update=function(){e.prototype.update.apply(this,arguments),h&&this.position.x<=0&&(h(),h=null,p())},this.components.physics.position.x=t+this.width/2,this.components.physics.position.y="T"===s?1-i/2:i/2,this.components.physics.velocity.x=-.35};i.exports=h},{"../components/collisions/rectangle":2,"../components/graphics/pipe":4,"../components/physics/physics":6,"../components/sound/sound":7}],10:[function(t,i,s){"use strict";var n=t("../components/graphics/player"),e=t("../components/physics/physics"),o=t("../components/sound/sound"),c=t("../components/collisions/circle"),h=function(){this.radius=.05,this.components={graphics:new n(this),sound:new o(this),collisions:new c(this,this.radius)},this.reset()};h.prototype.reset=function(){this.components.physics=new e,this.components.physics.position.y=.5,this.components.sound.resetSound()},h.prototype.start=function(){this.components.physics.acceleration.y=-1.75},h.prototype.flap=function(){this.components.physics.velocity.y=.55,this.components.sound.flapSound()},h.prototype.die=function(){this.components.physics.velocity.y=0,this.components.physics.acceleration.y=0,this.components.sound.dieSound()},i.exports=h},{"../components/collisions/circle":1,"../components/graphics/player":5,"../components/physics/physics":6,"../components/sound/sound":7}],11:[function(t,i,s){"use strict";var n=t("./systems/graphics"),e=t("./systems/physics"),o=t("./systems/input"),c=t("./systems/obstacles"),h=t("./systems/ui"),r=t("./entities/player"),p=function(t){var i=this;this.player=new r,this.entities=[this.player],this.graphics=new n(this.entities,t),this.physics=new e(this.entities),this.input=new o(this.entities,t),this.obstacles=new c(this.entities,t),this.ui=new h,this.obstacles.onPassObstacle=function(){i.ui.bumpScore()},this.player.components.collisions.onCollision=function(){i.obstacles.pause(),i.graphics.pause(),i.physics.pause(),i.input.started=!1,i.ui.reset(),i.player.die()},this.ui.onReady=function(){i.player.reset(),i.obstacles.reset(),i.graphics.run(),i.physics.run()}};p.prototype.run=function(){var t=this;this.graphics.run(),this.input.run(),this.physics.run(),this.input.onStartGame=function(){return t.ui.isReady?(t.obstacles.run(),t.ui.start(),t.player.start(),!0):!1}},i.exports=p},{"./entities/player":10,"./systems/graphics":15,"./systems/input":16,"./systems/obstacles":17,"./systems/physics":18,"./systems/ui":19}],12:[function(t,i,s){"use strict";var n=function(){function t(t,i){var s=[],n=!0,e=!1,o=void 0;try{for(var c,h=t[Symbol.iterator]();!(n=(c=h.next()).done)&&(s.push(c.value),!i||s.length!==i);n=!0);}catch(r){e=!0,o=r}finally{try{!n&&h["return"]&&h["return"]()}finally{if(e)throw o}}return s}return function(i,s){if(Array.isArray(i))return i;if(Symbol.iterator in Object(i))return t(i,s);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),e=s;e.clamp=function(t,i,s){return i>t?i:t>s?s:t},e.subtract=function(t,i){return t-i},e.scale=function(t,i,s){var o=i.sort(e.subtract),c=n(o,2),h=c[0],r=c[1],p=s.sort(e.subtract),a=n(p,2),l=a[0],u=a[1],y=r-h,d=u-l;return(t-h)/y*d+l}},{}],13:[function(t,i,s){"use strict";var n=t("./flappy-trump");document.addEventListener("DOMContentLoaded",function(){var t=document.getElementById("main-canvas"),i=new n(t);i.run()})},{"./flappy-trump":11}],14:[function(t,i,s){"use strict";var n=function(t){this.entities=t};n.prototype.tick=function(){for(var t=0;t<this.entities.length;t++){var i=this.entities[t];if("collisions"in i.components)for(var s=t+1;s<this.entities.length;s++){var n=this.entities[s];"collisions"in n.components&&i.components.collisions.collidesWith(n)&&(i.components.collisions.onCollision&&i.components.collisions.onCollision(n),n.components.collisions.onCollision&&n.components.collisions.onCollision(i))}}},i.exports=n},{}],15:[function(t,i,s){(function(s){"use strict";var n=t("../entities/altitude-limit"),e=function(t,i){this.entities=t,this.canvas=i,this.context=i.getContext("2d")};e.prototype.run=function(){var t=e.prototype.tick.bind(this);!function i(){s.requestAnimationFrame(function(s){t(s,i)})}()},e.prototype.pause=function(){this.tick=function(){}},e.prototype.tick=function(t,i){var s=this;(this.canvas.width!==this.canvas.offsetWith||this.canvas.height!==this.canvas.offsetHeight)&&(this.canvas.width=this.canvas.offsetWidth,this.canvas.height=this.canvas.offsetHeight,this.entities.forEach(function(t){t instanceof n&&(t.width=s.canvas.width/s.canvas.height+.5)})),this.context.fillStyle=this.context.createLinearGradient(0,0,0,this.canvas.height),this.context.fillStyle.addColorStop(.25,"#fdfcfc"),this.context.fillStyle.addColorStop(1,"#b1b1b1"),this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.context.save(),this.context.translate(this.canvas.width/2,this.canvas.height),this.context.scale(this.canvas.height,-this.canvas.height),this.entities.forEach(function(t){t.components&&t.components.graphics&&t.components.graphics.draw(s.context)}),this.context.restore(),i&&i()},i.exports=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../entities/altitude-limit":8}],16:[function(t,i,s){"use strict";var n=function(t,i){this.entities=t,this.canvas=i,this.started=!1};n.prototype.run=function(){this.canvas.addEventListener("mousedown",this.onClick.bind(this)),this.canvas.addEventListener("touchstart",this.onTouchStart.bind(this)),this.canvas.addEventListener("touchend",this.onTouchEnd.bind(this)),this.canvas.addEventListener("touchmove",this.onTouchMove.bind(this)),this.canvas.addEventListener("touchcancel",this.onTouchCancel.bind(this))},n.prototype.onClick=function(t){if(t.preventDefault(),!this.started){if(!this.onStartGame())return;this.started=!0}var i=this.entities[0];i.flap()},n.prototype.onTouchStart=function(t){t.preventDefault(),this.touching||this.onClick(),this.touching=!0},n.prototype.onTouchEnd=function(t){t.preventDefault(),this.touching=!1},n.prototype.onTouchMove=function(t){t.preventDefault()},n.prototype.onTouchCancel=function(t){t.preventDefault(),this.touching=!1},i.exports=n},{}],17:[function(t,i,s){"use strict";var n=t("../entities/pipe"),e=t("../entities/altitude-limit"),o=t("../helpers").scale,c=function(t,i){this.entities=t,this.canvas=i,this.ground=new e(0),this.ceiling=new e(1.01),this.entities.push(this.ground,this.ceiling),this.intvl=null};c.prototype.reset=function(){for(var t=this.entities.length-1;t>=0;t--)this.entities[t]instanceof n&&this.entities.splice(t,1)},c.prototype.run=function(){this.reset(),this.intvl=window.setInterval(this.tick.bind(this),2e3)},c.prototype.pause=function(){this.intvl&&window.clearInterval(this.intvl),this.intvl=null},c.prototype.tick=function(){var t=this,i=this.canvas.width/2/this.canvas.height,s=o(Math.random(),[0,1],[.2,.8]),e=.25,c=s-e/2,h=1-c-e,r=this.onPassObstacle.bind(this);this.entities.push(new n(i,c,"T",r)),this.entities.push(new n(i,h,"B")),this.entities.forEach(function(s,n){s.components.physics.position.x<-i-s.width/2&&t.entities.splice(n,1)})},c.prototype.onPassObstacle=function(){},i.exports=c},{"../entities/altitude-limit":8,"../entities/pipe":9,"../helpers":12}],18:[function(t,i,s){"use strict";var n=t("./collisions"),e=function(t){this.entities=t,this.collisions=new n(t),this.intvl=null};e.prototype.run=function(){this.intvl=setInterval(this.tick.bind(this),1e3/60)},e.prototype.pause=function(){this.intvl&&clearInterval(this.intvl),this.intvl=null},e.prototype.tick=function(){this.entities.forEach(function(t){t.components&&t.components.physics&&t.components.physics.update(1/60)}),this.collisions.tick()},i.exports=e},{"./collisions":14}],19:[function(t,i,s){"use strict";var n=function(){this.highScore=localStorage.getItem("ft-high-score")||0,this.endingSplashElt=document.getElementById("ft-ending-splash"),this.finalScoreElt=document.getElementById("ft-final-score"),this.highScoreElt=document.getElementById("ft-high-score"),this.readyButton=document.getElementById("ft-ready-button"),this.readySplashElt=document.getElementById("ft-ready-splash"),this.scoreElt=document.getElementById("ft-score"),this.readyButton.onclick=this.ready.bind(this),this.ready()};n.prototype.ready=function(){this.endingSplashElt.style.display="none",this.scoreElt.style.display="inline-block",this.readySplashElt.style.display="inline-block",this.score=0,this.scoreElt.textContent="0",this.isReady=!0,this.onReady()},n.prototype.onReady=function(){},n.prototype.start=function(){this.endingSplashElt.style.display="none",this.scoreElt.style.display="inline-block",this.readySplashElt.style.display="none"},n.prototype.reset=function(){this.highScore=Math.max(this.highScore,this.score),localStorage.setItem("ft-high-score",this.highScore),this.highScoreElt.textContent=this.highScore.toString(),this.finalScoreElt.textContent=this.score.toString(),this.endingSplashElt.style.display="inline-block",this.scoreElt.style.display="none",this.readySplashElt.style.display="none",this.isReady=!1},n.prototype.bumpScore=function(){this.scoreElt.textContent=(++this.score).toString()},i.exports=n},{}]},{},[13]);
//# sourceMappingURL=app.min.js.map
